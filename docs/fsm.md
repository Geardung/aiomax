# FSM (Конечные автоматы)

Фреймворк aiomax имеет встроенные конечные автоматы.

Конечные автоматы помогают создавать формы (опросы) и передавать данные пользователей между функциями

Пример бота, использующего FSM, можете посмотреть в [examples.md](examples.md)

FSM имеет 2 понятия:

- `State` - состояние пользователя. Например, что он должен ввести

- `Data` - данные пользователя, передающиеся между функциями

Для работы с FSM используются 2 класса: `FSMStorage` и `FSMCursor`

## `FSMStorage()`

Хранилище данных. Создается своё для каждого бота

### `FSMStorage.get_state(user_id) -> Any`

Возвращает текущее состояние пользователя. `None`, если пользователя нет в хранилище

### `FSMStorage.get_data(user_id) -> Any`

Возвращает текущие данные пользователя. `None`, если пользователя нет в хранилище

### `FSMStorage.change_state(user_id, new)`

Изменяет состояние пользователя

### `FSMStorage.change_data(user_id, new)`

Изменяет данные пользователя

### `FSMStorage.clear_state(user_id) -> Any`

Очищает состояние пользователя и возвращает старое значение

### `FSMStorage.clear_data(user_id) -> Any`

Очищает данные пользователя и возвращает старое значение

### `FSMStorage.clear(user_id) -> None`

Очищает состояние и данные пользователя

## `FSMCursor(user_id)`

Имеет все те же функции, что и `FSMStorage`, но не имеет параметра `user_id` в них. Оперирует только над одним пользователем

Передается во всех [декораторах](decorators.md), кроме `on_button_chat_create()`, как аргумент `cursor` с идентификатором пользователя, совершившего действие
