# FSM (Конечные автоматы)

Фреймворк aiomax имеет встроенные конечные автоматы

В aiomax это помогает создавать формы (опросы) и передавать данные пользователей между функциями

Пример бота использующего FSM можете посмотреть в [examples.md](examples.md)

В aiomax у FSM есть 2 понятия:

- `State` - состояние пользователя. Например, что он должен ввести

- `Data` - данные пользователя, передающиеся между функциями

Для работы с FSM в aiomax используются 2 класса: `FSMStorage` и `FSMCursor`

## `FSMStorage()`

Хранилище данных. Может быть одно у одного бота

### `FSMStorage.get_state(user_id) -> Any`

Возвращает состояние пользователя. `None` если пользователя нет в хранилище

### `FSMStorage.get_data(user_id) -> Any`

Возвращает данные пользователя. `None` если пользователя нет в хранилище

### `FSMStorage.change_state(user_id, new) -> None`

Изменяет состояние пользователя

### `FSMStorage.change_data(user_id, new) -> None`

Изменяет данные пользователя

### `FSMStorage.clear_state(user_id) -> Any`

Очищает состояние пользователя и возвращает старое значение

### `FSMStorage.clear_data(user_id, new) -> Any`

Очищает данные пользователя и возвращает старое значение

### `FSMStorage.clear(user_id, new) -> None`

Очищает состояние и данные пользователя

## `FSMCursor(user_id)`

Имеет все те же функции, что и `FSMStorage`, но не имеет параметра `user_id` в них. Оперирует только над одним пользователем

Передается во всех [декораторах](decorators.md) кроме `on_button_chat_create()` как объект `cursor` с идентификатором пользователя, совершившего действие
